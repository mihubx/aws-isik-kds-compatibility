/// url = "http://mihubx.de/fhir/StructureMap/MHX_SM_IsikToKds"
/// name = "MHX_SM_IsikToKds"
/// title = "ISiK Basismodul 3.0.0 to MII KDS Person 1.0.16 Conversions"
/// status = "draft"

uses "https://gematik.de/fhir/isik/v3/Basismodul/StructureDefinition/ISiKPatient" alias ISiKPatient as source
uses "https://www.medizininformatik-initiative.de/fhir/core/modul-person/StructureDefinition/Patient" alias KDSPatient as target

group MapPatient(source src: ISiKPatient, target tgt: KDSPatient) {
    src.id as s_id -> tgt.id = s_id;
    src.meta as s_meta -> tgt.meta as t_meta then MapMeta(s_meta, t_meta);
    src.text as s_text -> tgt.text = s_text;
    src.identifier as s_identifier -> tgt.identifier = s_identifier;
    src.active -> tgt.active;
    src.name as s_name -> tgt.name = s_name;
    src.telecom as s_telecom -> tgt.telecom = s_telecom;
    src.gender as s_gender -> tgt.gender = s_gender;
    src.birthDate as s_date -> tgt.birthDate = s_date;
    src.deceasedDateTime as s_deceased -> tgt.deceasedDateTime = s_deceased;
    src.address as s_address -> tgt.address = s_address;
    src.martialStatus as s_martialStatus -> tgt.martialStatus = s_martialStatus;
    src.photo as s_photo -> tgt.photo as s_photo;
    src.communication as s_communication -> tgt.communication = s_communication;
    src.generalPractitioner as s_generalPractitioner -> tgt.generalPractitioner = s_generalPractitioner;
}

group MapMeta(source src: Meta, target tgt: Meta) {
    src.lastUpdated as s_lastUpdated -> tgt.lastUpdated = s_lastUpdated;
    src.versionId as s_versionId -> tgt.versionId = s_versionId;
    src.source as s_source -> tgt.source = s_source;
    src.profile as s_profile -> tgt.profile = "https://www.medizininformatik-initiative.de/fhir/core/modul-person/StructureDefinition/Patient";
    src.security as s_security -> tgt.security = s_security;
    src.tag as s_tag -> tgt.tag = s_tag;
}